const translations = {
  zh: {
    "meta.title": "知时 · Zhishi — Windows 上的高级时间管理体验",
    "meta.description": "知时是 Windows 平台上的高级时间管理工具，提供原子化日程洞察、跨平台同步与沉浸式体验，让每一段专注都值得被记录。",
    "lang.zh": "中文",
    "lang.en": "English",
    "nav.features": "产品特性",
    "nav.scenarios": "使用场景",
    "nav.faq": "常见问题",
    "nav.download": "下载",
    "nav.cta": "获取知时",
    "hero.eyebrow": "为深度工作者打造",
    "hero.title": "知时 — Windows 上的高级时间掌控体验",
    "hero.subtitle": "融合 Dayflow 的极简质感与 Windows 原生性能，知时为追求效率与优雅的你重新定义时间管理。从计划到执行，捕捉每一个灵感瞬间。",
    "hero.primary": "立即下载安装包",
    "hero.secondary": "观看一分钟体验",
    "hero.note": "<strong>40,000+</strong> 新知工作者正在用知时协调日程、专注与灵感。",
    "hero.schedule.date": "5月23日",
    "hero.schedule.day": "周四",
    "hero.schedule.item1": "晨间深度工作：战略规划",
    "hero.schedule.item2": "团队进度同步：产品迭代",
    "hero.schedule.item3": "夜间灵感整理：创意库",
    "hero.schedule.tag1": "专注",
    "hero.schedule.tag2": "协作",
    "hero.schedule.tag3": "深潜",
    "features.eyebrow": "核心特性",
    "features.title": "以高级质感演绎时间的秩序",
    "features.subtitle": "精炼 Dayflow 的设计哲学，专为 Windows 用户调校，保持极简、敏捷与优雅。",
    "features.card1.title": "原子化日程洞察",
    "features.card1.copy": "多维卡片式日程，聚焦重点，自动捕捉冲突和空档。",
    "features.card1.item1": "智能聚合会议、专注与提醒",
    "features.card1.item2": "时间线与分块视图一键切换",
    "features.card1.item3": "可视化能量曲线掌握节奏",
    "features.card2.title": "跨平台无缝同步",
    "features.card2.copy": "与 iOS、Android、Web 保持实时一致，协作无需等待。",
    "features.card2.item1": "连接主流日历与任务系统",
    "features.card2.item2": "延迟不到 200ms 的秒级同步",
    "features.card2.item3": "离线模式自动补发更新",
    "features.card3.title": "沉浸式专注体验",
    "features.card3.copy": "暗黑渐层与柔和动效，让专注更沉浸，信息更清晰。",
    "features.card3.item1": "自定义专注模式与状态",
    "features.card3.item2": "桌面小组件即时反馈",
    "features.card3.item3": "系统级快捷键快速调用",
    "scenarios.eyebrow": "使用场景",
    "scenarios.title": "懂你每个瞬间的时间需求",
    "scenarios.subtitle": "无论是产品经理、设计师或创作者，知时都能贴合你的节奏。",
    "scenarios.card1.badge": "产品规划",
    "scenarios.card1.title": "从灵感到里程碑的完整闭环",
    "scenarios.card1.copy": "通过能量标记识别高价值时间区段，结合决策看板对齐团队节奏。",
    "scenarios.card2.badge": "创意调度",
    "scenarios.card2.title": "让创意与执行同步发生",
    "scenarios.card2.copy": "以色彩层级区分灵感、制作与复盘，让作品始终保持灵感驱动。",
    "scenarios.card3.badge": "个人生长",
    "scenarios.card3.title": "记录每一次专注的成长轨迹",
    "scenarios.card3.copy": "习惯引擎结合番茄专注数据，量化专注质量，给自己可视化反馈。",
    "metrics.eyebrow": "数据见证",
    "metrics.title": "高效不是偶然，是可被量化的选择",
    "metrics.subtitle": "从 Beta 到正式版本，我们不断优化每一个细节，只为让你在 Windows 上也能拥有 Mac 级体验。",
    "metrics.value1": "96%",
    "metrics.label1": "体验满意度",
    "metrics.value2": "+2h",
    "metrics.label2": "平均每日深度时间增加",
    "metrics.value3": "<1s",
    "metrics.label3": "关键操作响应时间",
    "metrics.card.badge": "今日进度",
    "metrics.card.state": "状态：流动",
    "metrics.card.item1": "晨间能量指数 82%，适合策略规划",
    "metrics.card.item2": "设计评审自动关联需求文档",
    "metrics.card.item3": "专注 50 分钟后智能提醒休息",
    "metrics.card.item4": "夜间整理转为第二天灵感任务",
    "faq.eyebrow": "常见问题",
    "faq.title": "关于知时，你可能想问",
    "faq.subtitle": "如果这里没有解答，欢迎邮件联系我们：hello@zhishi.app",
    "faq.q1": "知时和现有的日历应用有什么不同？",
    "faq.a1": "知时以 Time OS 的视角重新组织日程，不仅同步你的日历，更会识别专注区间、能量趋势与协作窗口，带来更具洞察的时间管理体验。",
    "faq.q2": "知时是否支持团队协作与共享？",
    "faq.a2": "支持。知时可创建共享空间，与团队协同制定节点，实时同步任务状态，并提供权限管理与操作追踪。",
    "faq.q3": "我可以离线使用知时吗？",
    "faq.a3": "可以。离线时所有操作会缓存到本地，联网后将在 3 秒内自动同步到云端，确保数据完整无损。",
    "faq.q4": "如何参与测试或获取最新版本？",
    "faq.a4": "订阅知时实验室计划即可获得 Beta 优先体验、版本日志以及专属社区交流通道。",
    "cta.eyebrow": "立即上手",
    "cta.title": "开启你的高级时间管理旅程",
    "cta.subtitle": "下载 Windows 客户端，或申请加入跨平台体验计划。",
    "cta.primary": "下载 Windows 版本",
    "cta.secondary": "加入体验计划",
    "footer.features": "产品特性",
    "footer.support": "支持中心",
    "footer.contact": "合作联系",
    "footer.privacy": "隐私政策",
    "footer.copy": "© 2024 Zhishi Studio. 保留所有权利。"
  },
  en: {
    "meta.title": "Zhishi — A Refined Time OS for Windows",
    "meta.description": "Zhishi brings Dayflow-inspired minimalism to Windows with atomic scheduling, instant sync, and immersive focus modes for modern knowledge workers.",
    "lang.zh": "中文",
    "lang.en": "English",
    "nav.features": "Features",
    "nav.scenarios": "Scenarios",
    "nav.faq": "FAQ",
    "nav.download": "Download",
    "nav.cta": "Get Zhishi",
    "hero.eyebrow": "Crafted for deep workers",
    "hero.title": "Zhishi — Sophisticated Time Mastery on Windows",
    "hero.subtitle": "Inspired by Dayflow's polished simplicity, Zhishi reimagines scheduling on Windows with responsive performance and graceful interactions. Plan with clarity, execute with flow.",
    "hero.primary": "Download for Windows",
    "hero.secondary": "Watch the 1-min tour",
    "hero.note": "<strong>40,000+</strong> creators and strategists rely on Zhishi to orchestrate their focus and collaboration.",
    "hero.schedule.date": "May 23",
    "hero.schedule.day": "Thu",
    "hero.schedule.item1": "Morning deep work: strategic roadmap",
    "hero.schedule.item2": "Team sync: product iteration",
    "hero.schedule.item3": "Night capture: inspiration vault",
    "hero.schedule.tag1": "Focus",
    "hero.schedule.tag2": "Sync",
    "hero.schedule.tag3": "Deep",
    "features.eyebrow": "Feature set",
    "features.title": "Order and calm, distilled",
    "features.subtitle": "A Windows-native rendition of the Dayflow philosophy — minimal, agile, exquisitely tuned.",
    "features.card1.title": "Atomic schedule intelligence",
    "features.card1.copy": "Card-based timelines highlight what matters and surface conflicts before they occur.",
    "features.card1.item1": "Group meetings, focus, and alerts in one view",
    "features.card1.item2": "Switch between timeline and block layouts instantly",
    "features.card1.item3": "Visual energy graph keeps your pace aligned",
    "features.card2.title": "Seamless cross-platform sync",
    "features.card2.copy": "Stay aligned across iOS, Android, and Web with near real-time updates.",
    "features.card2.item1": "Connect popular calendars and task hubs",
    "features.card2.item2": "Sub-200ms delta sync for edits",
    "features.card2.item3": "Offline cache with auto reconciliation",
    "features.card3.title": "Immersive focus states",
    "features.card3.copy": "Soft gradients and subtle motion keep attention centered and signal context.",
    "features.card3.item1": "Tailored focus modes and status cues",
    "features.card3.item2": "Desktop widgets provide live insights",
    "features.card3.item3": "Global shortcuts summon key views",
    "scenarios.eyebrow": "Use cases",
    "scenarios.title": "Designed for every moment you lead",
    "scenarios.subtitle": "From PMs to designers and makers, Zhishi adapts to your cadence with ease.",
    "scenarios.card1.badge": "Product ops",
    "scenarios.card1.title": "Bring ideas to milestones effortlessly",
    "scenarios.card1.copy": "Energy tagging reveals impact windows, while shared boards align the squad in real time.",
    "scenarios.card2.badge": "Creative flow",
    "scenarios.card2.title": "Let ideation and delivery move in sync",
    "scenarios.card2.copy": "Color-coded phases keep sparks, production, and review in a continuous loop.",
    "scenarios.card3.badge": "Personal growth",
    "scenarios.card3.title": "Capture a trace of every focused sprint",
    "scenarios.card3.copy": "Habits + Pomodoro analytics quantify focus quality and celebrate micro-improvements.",
    "metrics.eyebrow": "Proof in numbers",
    "metrics.title": "Performance you can actually feel",
    "metrics.subtitle": "From beta to launch we refined each detail to bring a Mac-grade aura to Windows.",
    "metrics.value1": "96%",
    "metrics.label1": "Satisfaction rating",
    "metrics.value2": "+2h",
    "metrics.label2": "Avg. daily deep work gained",
    "metrics.value3": "<1s",
    "metrics.label3": "Action response time",
    "metrics.card.badge": "Today's flow",
    "metrics.card.state": "Status: fluid",
    "metrics.card.item1": "AM energy index at 82% — ideal for strategy",
    "metrics.card.item2": "Design review auto-linked to PRD",
    "metrics.card.item3": "Smart break prompt after 50 min focus",
    "metrics.card.item4": "Evening capture queued for tomorrow",
    "faq.eyebrow": "FAQ",
    "faq.title": "Answers before you ask",
    "faq.subtitle": "Need more? Email us at hello@zhishi.app and we'll get back within a day.",
    "faq.q1": "How is Zhishi different from a regular calendar?",
    "faq.a1": "Zhishi reorganises your schedule with a Time OS mindset. It interprets focus windows, energy trends, and collaboration signals to deliver richer context than standard calendars.",
    "faq.q2": "Does Zhishi support team collaboration?",
    "faq.a2": "Yes. Shared spaces let teams coordinate milestones, sync status instantly, and manage permissions with detailed activity trails.",
    "faq.q3": "Can I keep using Zhishi offline?",
    "faq.a3": "Absolutely. Actions cache locally and sync back within three seconds once your connection returns, preserving every change.",
    "faq.q4": "How do I access beta builds and updates?",
    "faq.a4": "Join the Zhishi Labs program to receive early builds, release notes, and access to our private community channel.",
    "cta.eyebrow": "Get started",
    "cta.title": "Step into refined time orchestration",
    "cta.subtitle": "Install the Windows client or apply to the cross-platform beta journey.",
    "cta.primary": "Download for Windows",
    "cta.secondary": "Join Zhishi Labs",
    "footer.features": "Features",
    "footer.support": "Support",
    "footer.contact": "Contact",
    "footer.privacy": "Privacy",
    "footer.copy": "© 2024 Zhishi Studio. All rights reserved."
  }
};

const translationElements = document.querySelectorAll("[data-i18n]");
const languageButtons = document.querySelectorAll("[data-lang]");
const descriptionMeta = document.querySelector('meta[name="description"]');

function applyTranslations(lang) {
  const messages = translations[lang] || translations.zh;

  translationElements.forEach((element) => {
    const key = element.dataset.i18n;
    const value = messages[key];

    if (typeof value === "undefined") {
      return;
    }

    if (element.dataset.i18nType === "html") {
      element.innerHTML = value;
    } else {
      element.textContent = value;
    }
  });

  languageButtons.forEach((button) => {
    const isActive = button.dataset.lang === lang;
    button.classList.toggle("active", isActive);
    button.setAttribute("aria-pressed", String(isActive));
  });

  document.documentElement.lang = lang === "zh" ? "zh-Hans" : "en";
  document.title = messages["meta.title"];
  if (descriptionMeta) {
    descriptionMeta.setAttribute("content", messages["meta.description"]);
  }

  try {
    localStorage.setItem("zhishi-lang", lang);
  } catch (error) {
    /* ignore storage errors */
  }
}

languageButtons.forEach((button) => {
  button.addEventListener("click", () => {
    const lang = button.dataset.lang;
    applyTranslations(lang);
  });
});

function initLanguage() {
  let lang = "zh";

  try {
    const stored = localStorage.getItem("zhishi-lang");
    if (stored && translations[stored]) {
      lang = stored;
    }
  } catch (error) {
    lang = "zh";
  }

  if (!translations[lang]) {
    lang = "zh";
  }

  applyTranslations(lang);
}

function initRevealObserver() {
  const elements = document.querySelectorAll("[data-observe]");

  if (!("IntersectionObserver" in window)) {
    elements.forEach((element) => element.classList.add("in-view"));
    return;
  }

  const observer = new IntersectionObserver(
    (entries, currentObserver) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("in-view");
          currentObserver.unobserve(entry.target);
        }
      });
    },
    {
      threshold: 0.15,
      rootMargin: "0px 0px -40px 0px"
    }
  );

  elements.forEach((element) => observer.observe(element));
}

initRevealObserver();
initLanguage();
